<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>代办事项</title>
<style>
    li{
    list-style-type:none
    }
</style>
</head>
<body>
<center id="a">
<ul>
    {% for value in data %}
    <li> {{ value[1] }} <button onclick="myFunction({{ value[0] }})"> 删除 </button></li>
    {% endfor %}
</ul>
<button  onclick="showDialog()">新增</button>
<dialog id="newTodoItem">
    <textarea id="todoText">hello world</textarea><br>
    <button onclick="hideDialog() ">no</button>
    <button onclick="addTodo()">yes</button>
</dialog>
</center>
</body>
<script>
        function myFunction(index){
            console.log('deleting',index)
            fetch('http://127.0.0.1:5000/todo/'+index,{method:'DELETE'})
            .then(
                function(response){
                <!--console.log(response.text());&lt;!&ndash; 点击删除，自己刷新页面消失&ndash;&gt;-->
                <!--return;-->
                console.log(response.json());
                }
            )
            .then(
                function(response){
                    window.location.reload();<!-- 自动删除-->
                }
            )
        }
        function showDialog(){
            document.getElementById('newTodoItem').showModal();
        }
        function hideDialog(){
            document.getElementById('newTodoItem').close();
        }
        function addTodo(){
            var text=document.getElementById('todoText').value;
            fetch('http://127.0.0.1:5000/todo',{
                headers:{'Content-Type':'application/json'},
                method:'POST',
                body:JSON.stringify({text:text})
        })
        document.getElementById('newTodoItem').close();
        window.location.reload()
        }
</script>
</html>